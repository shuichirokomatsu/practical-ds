<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>探索的データ分析</title>
  <meta name="description" content="要約メモ">

  <link rel="canonical" href="https://uribo.github.io/practical-ds/01/eda.html">
  <link rel="alternate" type="application/rss+xml" title="Data Science and Modeling in Practice" href="https://uribo.github.io/practical-ds/feed.xml">

  <meta property="og:url"         content="https://uribo.github.io/practical-ds/01/eda.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="探索的データ分析" />
<meta property="og:description" content="要約メモ" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://uribo.github.io/practical-ds/01/eda.html",
  "headline":
    "探索的データ分析",
  "datePublished":
    "2019-07-04T08:01:20+09:00",
  "dateModified":
    "2019-07-04T08:01:20+09:00",
  "description":
    "要約メモ",
  "author": {
    "@type": "Person",
    "name": "Shinya Uryu"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://uribo.github.io/practical-ds",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://uribo.github.io/practical-ds",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/practical-ds/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/practical-ds/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/practical-ds';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/practical-ds/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/practical-ds/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/practical-ds/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/practical-ds/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.highlighter-rouge:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/practical-ds/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/practical-ds/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/practical-ds/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/practical-ds/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://jupyter.org/jupyter-book/"><img src="/practical-ds/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Data Science and Modeling in Practice</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/practical-ds/intro.html"
        >
          
          Home
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="https://github.com/uribo/practical-ds"
        >
          
          GitHub repository
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/practical-ds/search.html">Search</a></li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Demo textbook</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/practical-ds/01/readme.html"
        >
          
          データ分析の流れ
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/01/introduction.html"
                >
                  
                  データ分析のプロセス
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/practical-ds/01/eda.html"
                >
                  
                  探索的データ分析
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/01/tidy_data.html"
                >
                  
                  tidyデータと前処理
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/01/tidymodels_workflow.html"
                >
                  
                  モデルの構築から評価まで
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/practical-ds/02/readme.html"
        >
          
          特徴量エンジニアリング
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/02/numeric.html"
                >
                  
                  数値データの取り扱い
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/02/categorical.html"
                >
                  
                  カテゴリデータの取り扱い
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/02/text.html"
                >
                  
                  テキストデータの取り扱い
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/02/date-and-time.html"
                >
                  
                  日付・時間データの取り扱い
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/02/spatial-data.html"
                >
                  
                  地理空間データの取り扱いの取り扱い
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/practical-ds/03/readme.html"
        >
          
          より良いモデルを目指して
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/handling-missing-data.html"
                >
                  
                  欠損値の処理
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/dimension-reduction.html"
                >
                  
                  次元削減
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/model-performance.html"
                >
                  
                  モデルの性能評価
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/data-splitting.html"
                >
                  
                  データ分割
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/feature-selection.html"
                >
                  
                  変数重要度
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/practical-ds/03/interpretability.html"
                >
                  
                  モデルの解釈
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#データを眺める">データを眺める</a>
    <ul>
      <li><a href="#データの大きさ">データの大きさ</a></li>
      <li><a href="#データの一部を表示">データの一部を表示</a></li>
      <li><a href="#各列の情報">各列の情報</a></li>
    </ul>
  </li>
  <li><a href="#要約統計量の算出">要約統計量の算出</a></li>
  <li><a href="#探索的データ分析">探索的データ分析</a></li>
  <li><a href="#数値データ">数値データ</a></li>
  <li><a href="#カテゴリデータ">カテゴリデータ</a></li>
  <li><a href="#論理値">論理値</a>
    <ul>
      <li><a href="#全体">全体</a></li>
      <li><a href="#1変数の可視化">1変数の可視化</a></li>
      <li><a href="#2変数の可視化">2変数の可視化</a></li>
    </ul>
  </li>
  <li><a href="#特殊なデータの視覚化">特殊なデータの視覚化</a>
    <ul>
      <li><a href="#時系列データ">時系列データ</a></li>
      <li><a href="#空間データ">空間データ</a></li>
      <li><a href="#高次元の可視化">高次元の可視化</a></li>
    </ul>
  </li>
</ul>
    </nav>
  </aside>


      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">





</div>


            <div class="c-textbook__content">
              <p>要約メモ</p>

<ul>
  <li>モデリング、統計分析を行う前にデータを精査することが大事
    <ol>
      <li>データの特徴を理解することで次のステップにかける時間を減らす、異常を見逃さない、（意図しない）間違いを見逃さない</li>
    </ol>
  </li>
  <li>特に可視化の手法を用いることでデータの集約や関係、パターンを見やすくする</li>
</ul>

<p>データを料理する前に、どのようなデータが与えられているのか確認することが大切です。
この段階を踏むことで、データに対する理解が深まり、より良いモデルの構築に繋がる可能性もあります。</p>

<p>探索的なデータ分析 (Exploratory Data Analysis: EDA) と呼ばれます。</p>

<ul>
  <li>データの集計、要約、可視化</li>
</ul>

<p>前章でもデータについて簡単な調査を行いましたが、データをグラフによって表現してみましょう。</p>

<p>グラフにすることで、集計値では見えなかった情報やデータ間の関係を表現することができます。</p>

<p>欠損値や異常値（外れ値）、データの分布</p>

<p>欠損値の視覚化については別の章で解説します。欠損の理解のためにも可視化は大事</p>

<p>目的変数として設定する地価価格に影響を及ぼす変数を明らかにしたい、またその関係を知りたいという状況を設定します。</p>

<h2 id="データを眺める">データを眺める</h2>

<!-- ここで扱うデータは地価データのみ。他のデータ、地価データの紹介は別のノート (`dataset/`)で。基本的に説明は地価データベース。データの性質に合わせて利用する。 -->

<p>データを手に入れたら、分析作業に取り掛かる前にまずはデータを眺めてみることにしましょう。眺める、と言ってもデータの値一つ一つを見ていくわけではありません。これから扱うデータは、どのような値が含まれているのか、データ型が処理されているか、また全体の大きさはどれくらいなのか、欠損はどれだけあるかと言った俯瞰的に整理していきます。</p>

<p>早い段階でデータの異常に気がつくことができたなら、データの特徴について理解が深められるのであればそれは今後の作業過程においても役立つでしょう。</p>

<p>csvファイルとしてデータが用意されている場面を想定します。csvファイルの読み込みにはいくつかの関数が利用できますが、ここでは <code class="highlighter-rouge">readr::read_csv()</code>を使った例を示します。</p>

<!-- train/testで色をわけるとか -->

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w"> </span><span class="c1"># データ操作パッケージ</span><span class="w">
</span></code></pre></div></div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">source</span><span class="p">(</span><span class="n">here</span><span class="o">::</span><span class="n">here</span><span class="p">(</span><span class="s2">"R/setup.R"</span><span class="p">))</span><span class="w">
</span><span class="n">search</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
&lt;ol class=list-inline&gt;
	<li>'.GlobalEnv'</li>
	<li>'package:tidyselect'</li>
	<li>'.conflicts'</li>
	<li>'package:drake'</li>
	<li>'package:conflicted'</li>
	<li>'package:cowplot'</li>
	<li>'package:naniar'</li>
	<li>'package:visdat'</li>
	<li>'package:janitor'</li>
	<li>'package:ensurer'</li>
	<li>'package:assertr'</li>
	<li>'package:sf'</li>
	<li>'package:yardstick'</li>
	<li>'package:rsample'</li>
	<li>'package:recipes'</li>
	<li>'package:parsnip'</li>
	<li>'package:infer'</li>
	<li>'package:dials'</li>
	<li>'package:scales'</li>
	<li>'package:broom'</li>
	<li>'package:tidymodels'</li>
	<li>'package:forcats'</li>
	<li>'package:stringr'</li>
	<li>'package:purrr'</li>
	<li>'package:tidyr'</li>
	<li>'package:tibble'</li>
	<li>'package:ggplot2'</li>
	<li>'package:tidyverse'</li>
	<li>'package:dplyr'</li>
	<li>'package:readr'</li>
	<li>'package:jsonlite'</li>
	<li>'jupyter:irkernel'</li>
	<li>'package:stats'</li>
	<li>'package:graphics'</li>
	<li>'package:grDevices'</li>
	<li>'package:utils'</li>
	<li>'package:datasets'</li>
	<li>'JapanEnv'</li>
	<li>'package:methods'</li>
	<li>'Autoloads'</li>
	<li>'package:base'</li>
&lt;/ol&gt;

</div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">Petal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"あやめ"</span><span class="p">,</span><span class="w"> </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'ああ'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_5_0.png" alt="png" /></p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
    </span><span class="n">read_csv</span><span class="p">(</span><span class="n">here</span><span class="o">::</span><span class="n">here</span><span class="p">(</span><span class="s2">"data-raw/landprice_kanto.csv"</span><span class="p">),</span><span class="w">
                    </span><span class="n">col_types</span><span class="w"> </span><span class="o">=</span><span class="w"> 
                      </span><span class="n">cols</span><span class="p">(</span><span class="n">.row_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">prefecture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">administrative_area_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">posted_land_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">name_of_nearest_station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">distance_from_station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">acreage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">current_use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">building_structure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_supplied_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">water_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">gas_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">sewage_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">depth_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">,</span><span class="w">
                           </span><span class="n">number_of_floors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">number_of_basement_floors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"i"</span><span class="p">,</span><span class="w">
                           </span><span class="n">use_district</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">building_coverage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">,</span><span class="w">
                           </span><span class="n">configuration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">surrounding_present_usage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">fire_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">urban_planning_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_floor_area_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">frontage_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">,</span><span class="w">
                           </span><span class="n">floor_area_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_selected_land_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_acreage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_current_use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_building_structure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_distance_from_station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_use_district</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_fire_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_urban_planning_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_forest_law</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_parks_law</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">attribute_change_building_coverage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">common_surveyed_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w">
                           </span><span class="n">.longitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">,</span><span class="w"> 
                           </span><span class="n">.latitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><code class="highlighter-rouge">readr::read_csv()</code> をはじめとしたcsv読み込み関数では、データフレームとしてcsvファイルを処理します。データフレームはデータを行と列をもつ表形式のオブジェクトとして扱えるものです。</p>

<h3 id="データの大きさ">データの大きさ</h3>

<p>データフレームは行と列からなります。いくつかの関数を使って読み込んだデータの大きさを調べてみましょう。</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">dim</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
&lt;ol class=list-inline&gt;
	<li>7961</li>
	<li>40</li>
&lt;/ol&gt;

</div>

<p><code class="highlighter-rouge">dim()</code>をデータフレームに適用すると、そのサイズを数値ベクトルで返します。最初の要素が行数、2番目の数字が列数を示します。これは次の<code class="highlighter-rouge">ncol()</code>、<code class="highlighter-rouge">nrow()</code>により個別に求めることができます。</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nrow</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span><span class="n">ncol</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
7961
</div>

<div class="output output_html">
40
</div>

<h3 id="データの一部を表示">データの一部を表示</h3>

<p>データフレームの一部を表示して、列名と値の確認をしてみましょう。<code class="highlighter-rouge">head()</code>をデータフレームに対して実行すると先頭の数行を表示します。また<code class="highlighter-rouge">tail()</code> でデータフレームの最後の行を表示することができます。いずれの関数も引数<code class="highlighter-rouge">n = </code> に実数を与えることで表示される行数を制御可能です。</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">

</span><span class="n">tail</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
<table>
<caption>A tibble: 6 × 40</caption>
<thead>
	<tr>&lt;th scope=col&gt;.row_id&lt;/th&gt;&lt;th scope=col&gt;prefecture&lt;/th&gt;&lt;th scope=col&gt;administrative_area_code&lt;/th&gt;&lt;th scope=col&gt;posted_land_price&lt;/th&gt;&lt;th scope=col&gt;name_of_nearest_station&lt;/th&gt;&lt;th scope=col&gt;distance_from_station&lt;/th&gt;&lt;th scope=col&gt;acreage&lt;/th&gt;&lt;th scope=col&gt;current_use&lt;/th&gt;&lt;th scope=col&gt;building_structure&lt;/th&gt;&lt;th scope=col&gt;attribute_change_supplied_facility&lt;/th&gt;&lt;th scope=col&gt;⋯&lt;/th&gt;&lt;th scope=col&gt;attribute_change_distance_from_station&lt;/th&gt;&lt;th scope=col&gt;attribute_change_use_district&lt;/th&gt;&lt;th scope=col&gt;attribute_change_fire_area&lt;/th&gt;&lt;th scope=col&gt;attribute_change_urban_planning_area&lt;/th&gt;&lt;th scope=col&gt;attribute_change_forest_law&lt;/th&gt;&lt;th scope=col&gt;attribute_change_parks_law&lt;/th&gt;&lt;th scope=col&gt;attribute_change_building_coverage&lt;/th&gt;&lt;th scope=col&gt;common_surveyed_position&lt;/th&gt;&lt;th scope=col&gt;.longitude&lt;/th&gt;&lt;th scope=col&gt;.latitude&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;⋯&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>11955</td><td>群馬県</td><td>10426</td><td>39000</td><td>長野原草津口</td><td>13000</td><td>166</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.5921</td><td>36.61913</td></tr>
	<tr><td>11956</td><td>群馬県</td><td>10426</td><td>56800</td><td>長野原草津口</td><td>13000</td><td>226</td><td>店舗     </td><td>W1</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.5933</td><td>36.62025</td></tr>
	<tr><td>11965</td><td>群馬県</td><td>10426</td><td>29800</td><td>長野原草津口</td><td>14000</td><td>173</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.6083</td><td>36.62088</td></tr>
	<tr><td>12079</td><td>群馬県</td><td>10211</td><td>24900</td><td>西松井田    </td><td>  950</td><td>112</td><td>住宅,店舗</td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.7953</td><td>36.31541</td></tr>
	<tr><td>12086</td><td>群馬県</td><td>10211</td><td>20500</td><td>松井田      </td><td>  750</td><td>264</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.8013</td><td>36.31065</td></tr>
	<tr><td>12103</td><td>群馬県</td><td>10429</td><td>13300</td><td>群馬原町    </td><td> 1400</td><td>329</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>138.8224</td><td>36.56371</td></tr>
</tbody>
</table>

</div>

<div class="output output_html">
<table>
<caption>A tibble: 3 × 40</caption>
<thead>
	<tr>&lt;th scope=col&gt;.row_id&lt;/th&gt;&lt;th scope=col&gt;prefecture&lt;/th&gt;&lt;th scope=col&gt;administrative_area_code&lt;/th&gt;&lt;th scope=col&gt;posted_land_price&lt;/th&gt;&lt;th scope=col&gt;name_of_nearest_station&lt;/th&gt;&lt;th scope=col&gt;distance_from_station&lt;/th&gt;&lt;th scope=col&gt;acreage&lt;/th&gt;&lt;th scope=col&gt;current_use&lt;/th&gt;&lt;th scope=col&gt;building_structure&lt;/th&gt;&lt;th scope=col&gt;attribute_change_supplied_facility&lt;/th&gt;&lt;th scope=col&gt;⋯&lt;/th&gt;&lt;th scope=col&gt;attribute_change_distance_from_station&lt;/th&gt;&lt;th scope=col&gt;attribute_change_use_district&lt;/th&gt;&lt;th scope=col&gt;attribute_change_fire_area&lt;/th&gt;&lt;th scope=col&gt;attribute_change_urban_planning_area&lt;/th&gt;&lt;th scope=col&gt;attribute_change_forest_law&lt;/th&gt;&lt;th scope=col&gt;attribute_change_parks_law&lt;/th&gt;&lt;th scope=col&gt;attribute_change_building_coverage&lt;/th&gt;&lt;th scope=col&gt;common_surveyed_position&lt;/th&gt;&lt;th scope=col&gt;.longitude&lt;/th&gt;&lt;th scope=col&gt;.latitude&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;⋯&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;lgl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>21343</td><td>茨城県</td><td>08232</td><td>15600</td><td>銚子</td><td>3200</td><td>125</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>140.8311</td><td>35.74772</td></tr>
	<tr><td>21363</td><td>千葉県</td><td>12202</td><td>41200</td><td>銚子</td><td>1800</td><td>119</td><td>住宅,店舗</td><td>S3</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>140.8434</td><td>35.73295</td></tr>
	<tr><td>21375</td><td>千葉県</td><td>12202</td><td>31500</td><td>銚子</td><td>2200</td><td>111</td><td>住宅     </td><td>W2</td><td>FALSE</td><td>⋯</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>140.8480</td><td>35.73405</td></tr>
</tbody>
</table>

</div>

<h3 id="各列の情報">各列の情報</h3>

<p>データ型や件数、欠損の状況を調べます。</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">glimpse</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Observations: 7,961
Variables: 40
$ .row_id                                [3m[38;5;246m&lt;int&gt;[39m[23m 11955, 11956, 11965, 12079, 1…
$ prefecture                             [3m[38;5;246m&lt;chr&gt;[39m[23m "群馬県", "群馬県", "群馬県", "群馬県", "…
$ administrative_area_code               [3m[38;5;246m&lt;chr&gt;[39m[23m "10426", "10426", "10426", "1…
$ posted_land_price                      [3m[38;5;246m&lt;int&gt;[39m[23m 39000, 56800, 29800, 24900, 2…
$ name_of_nearest_station                [3m[38;5;246m&lt;chr&gt;[39m[23m "長野原草津口", "長野原草津口", "長野原草津口",…
$ distance_from_station                  [3m[38;5;246m&lt;int&gt;[39m[23m 13000, 13000, 14000, 950, 750…
$ acreage                                [3m[38;5;246m&lt;int&gt;[39m[23m 166, 226, 173, 112, 264, 329,…
$ current_use                            [3m[38;5;246m&lt;chr&gt;[39m[23m "住宅", "店舗", "住宅", "住宅,店舗", "住…
$ building_structure                     [3m[38;5;246m&lt;chr&gt;[39m[23m "W2", "W1", "W2", "W2", "W2",…
$ attribute_change_supplied_facility     [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ water_facility                         [3m[38;5;246m&lt;lgl&gt;[39m[23m TRUE, TRUE, TRUE, TRUE, TRUE,…
$ gas_facility                           [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ sewage_facility                        [3m[38;5;246m&lt;lgl&gt;[39m[23m TRUE, TRUE, TRUE, FALSE, FALS…
$ depth_ratio                            [3m[38;5;246m&lt;dbl&gt;[39m[23m 1.0, 2.0, 1.0, 3.0, 1.0, 1.5,…
$ number_of_floors                       [3m[38;5;246m&lt;int&gt;[39m[23m 2, 1, 2, 2, 2, 2, 2, 2, 2, 2,…
$ number_of_basement_floors              [3m[38;5;246m&lt;int&gt;[39m[23m 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ use_district                           [3m[38;5;246m&lt;chr&gt;[39m[23m "2住居", "近商", "2住居", "近商", "1住…
$ building_coverage                      [3m[38;5;246m&lt;dbl&gt;[39m[23m 60, 80, 60, 80, 60, 60, 80, 6…
$ configuration                          [3m[38;5;246m&lt;chr&gt;[39m[23m NA, "台形", NA, NA, "台形", "台形",…
$ surrounding_present_usage              [3m[38;5;246m&lt;chr&gt;[39m[23m "一般住宅の中にアパート等が混在する住宅地域", "土産店…
$ fire_area                              [3m[38;5;246m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, N…
$ urban_planning_area                    [3m[38;5;246m&lt;chr&gt;[39m[23m "非線引", "非線引", "非線引", "非線引", "…
$ attribute_change_floor_area_ratio      [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ frontage_ratio                         [3m[38;5;246m&lt;dbl&gt;[39m[23m 1.2, 1.0, 1.0, 1.0, 1.2, 1.0,…
$ floor_area_ratio                       [3m[38;5;246m&lt;dbl&gt;[39m[23m 200, 300, 200, 200, 200, 200,…
$ attribute_change_selected_land_status  [3m[38;5;246m&lt;chr&gt;[39m[23m "1", "1", "1", "1", "1", "1",…
$ attribute_change_address               [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, TRUE, FA…
$ attribute_change_acreage               [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_current_use           [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_building_structure    [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_distance_from_station [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_use_district          [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_fire_area             [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_urban_planning_area   [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_forest_law            [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_parks_law             [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ attribute_change_building_coverage     [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ common_surveyed_position               [3m[38;5;246m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, F…
$ .longitude                             [3m[38;5;246m&lt;dbl&gt;[39m[23m 138.5921, 138.5933, 138.6083,…
$ .latitude                              [3m[38;5;246m&lt;dbl&gt;[39m[23m 36.61913, 36.62025, 36.62088,…

</code></pre></div></div>

<p>この地価データには40の列（変数）があります。</p>

<ul>
  <li>データの型 (<code class="highlighter-rouge">character</code>, <code class="highlighter-rouge">numeric</code>, <code class="highlighter-rouge">logical</code>, <code class="highlighter-rouge">factor</code>)</li>
  <li>欠損数、ユニーク数</li>
  <li>文字データの長さの幅</li>
  <li>カテゴリデータの偏り、水準、順序</li>
  <li>
    <p>数値データの要約統計量、分布（ヒストグラム）</p>
  </li>
  <li><code class="highlighter-rouge">configuration</code>や<code class="highlighter-rouge">fire_area</code>は欠損が多いことがわかります。<code class="highlighter-rouge">building_structure</code>にもわずかですが欠損データがあります。</li>
</ul>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 同一のデータで重複があるもの</span><span class="w">
</span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">tidyr</span><span class="o">::</span><span class="n">separate_rows</span><span class="p">(</span><span class="s2">"current_use"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">","</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">count</span><span class="p">(</span><span class="n">.row_id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">distinct</span><span class="p">(</span><span class="n">.row_id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">nrow</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ensure</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1945L</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
1945
</div>

<p>どのような情報が必要でしょうか。</p>

<p>明確な答えがあるわけではありませんが、以下の情報はデータ全体、各変数について把握しておくと良いでしょう。またデータの偏りや出現傾向、分布のパターンは可視化を行い確認するのが効率的です。これらは次の探索的データ分析で扱います。</p>

<p>データフレーム前提で…</p>

<ul>
  <li>サイズ（列数、行数）</li>
  <li>各列のデータ型… 離散（カテゴリ）、連続値</li>
  <li>完全データ、欠損データ</li>
</ul>

<h2 id="要約統計量の算出">要約統計量の算出</h2>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    .row_id       prefecture        administrative_area_code posted_land_price 
 Min.   :11955   Length:7961        Length:7961              Min.   :    5660  
 1st Qu.:14496   Class :character   Class :character         1st Qu.:   74500  
 Median :16488   Mode  :character   Mode  :character         Median :  167000  
 Mean   :16531                                               Mean   :  440857  
 3rd Qu.:18518                                               3rd Qu.:  323000  
 Max.   :21375                                               Max.   :55500000  
 name_of_nearest_station distance_from_station    acreage        
 Length:7961             Min.   :    0         Min.   :    46.0  
 Class :character        1st Qu.:  500         1st Qu.:   136.0  
 Mode  :character        Median :  900         Median :   176.0  
                         Mean   : 1394         Mean   :   748.1  
                         3rd Qu.: 1700         3rd Qu.:   249.0  
                         Max.   :24000         Max.   :413215.0  
 current_use        building_structure attribute_change_supplied_facility
 Length:7961        Length:7961        Mode :logical                     
 Class :character   Class :character   FALSE:7917                        
 Mode  :character   Mode  :character   TRUE :44                          
                                                                         
                                                                         
                                                                         
 water_facility  gas_facility    sewage_facility  depth_ratio   
 Mode :logical   Mode :logical   Mode :logical   Min.   :1.000  
 FALSE:8         FALSE:1401      FALSE:377       1st Qu.:1.000  
 TRUE :7953      TRUE :6560      TRUE :7584      Median :1.500  
                                                 Mean   :1.468  
                                                 3rd Qu.:1.500  
                                                 Max.   :6.500  
 number_of_floors number_of_basement_floors use_district      
 Min.   : 0.000   Min.   :0.00000           Length:7961       
 1st Qu.: 2.000   1st Qu.:0.00000           Class :character  
 Median : 2.000   Median :0.00000           Mode  :character  
 Mean   : 2.782   Mean   :0.08052                             
 3rd Qu.: 3.000   3rd Qu.:0.00000                             
 Max.   :52.000   Max.   :6.00000                             
 building_coverage configuration      surrounding_present_usage
 Min.   :30.00     Length:7961        Length:7961              
 1st Qu.:50.00     Class :character   Class :character         
 Median :60.00     Mode  :character   Mode  :character         
 Mean   :60.38                                                 
 3rd Qu.:60.00                                                 
 Max.   :80.00                                                 
  fire_area         urban_planning_area attribute_change_floor_area_ratio
 Length:7961        Length:7961         Mode :logical                    
 Class :character   Class :character    FALSE:7959                       
 Mode  :character   Mode  :character    TRUE :2                          
                                                                         
                                                                         
                                                                         
 frontage_ratio  floor_area_ratio attribute_change_selected_land_status
 Min.   :1.000   Min.   :  50.0   Length:7961                          
 1st Qu.:1.000   1st Qu.: 100.0   Class :character                     
 Median :1.000   Median : 200.0   Mode  :character                     
 Mean   :1.067   Mean   : 218.6                                        
 3rd Qu.:1.000   3rd Qu.: 200.0                                        
 Max.   :5.500   Max.   :1300.0                                        
 attribute_change_address attribute_change_acreage attribute_change_current_use
 Mode :logical            Mode :logical            Mode :logical               
 FALSE:7899               FALSE:7939               FALSE:7888                  
 TRUE :62                 TRUE :22                 TRUE :73                    
                                                                               
                                                                               
                                                                               
 attribute_change_building_structure attribute_change_distance_from_station
 Mode :logical                       Mode :logical                         
 FALSE:7893                          FALSE:7918                            
 TRUE :68                            TRUE :43                              
                                                                           
                                                                           
                                                                           
 attribute_change_use_district attribute_change_fire_area
 Mode :logical                 Mode :logical             
 FALSE:7960                    FALSE:7902                
 TRUE :1                       TRUE :59                  
                                                         
                                                         
                                                         
 attribute_change_urban_planning_area attribute_change_forest_law
 Mode :logical                        Mode :logical              
 FALSE:7960                           FALSE:7961                 
 TRUE :1                                                         
                                                                 
                                                                 
                                                                 
 attribute_change_parks_law attribute_change_building_coverage
 Mode :logical              Mode :logical                     
 FALSE:7961                 FALSE:7959                        
                            TRUE :2                           
                                                              
                                                              
                                                              
 common_surveyed_position   .longitude      .latitude    
 Mode :logical            Min.   :138.6   Min.   :34.98  
 FALSE:7357               1st Qu.:139.5   1st Qu.:35.59  
 TRUE :604                Median :139.7   Median :35.71  
                          Mean   :139.7   Mean   :35.77  
                          3rd Qu.:139.9   3rd Qu.:35.88  
                          Max.   :140.8   Max.   :37.02  
</code></pre></div></div>

<p>Rの組み込み関数として用意されている <code class="highlighter-rouge">summary()</code> を利用して、データフレームに含まれる列の要約統計量を得ることができます。</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 論理値型で標準偏差0の列を特定 constant cols</span><span class="w">
</span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.logical</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">as.numeric</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise_all</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">tidyr</span><span class="o">::</span><span class="n">gather</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
<table>
<caption>A tibble: 17 × 2</caption>
<thead>
	<tr>&lt;th scope=col&gt;key&lt;/th&gt;&lt;th scope=col&gt;value&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>attribute_change_supplied_facility    </td><td>0.07414234</td></tr>
	<tr><td>water_facility                        </td><td>0.03168620</td></tr>
	<tr><td>gas_facility                          </td><td>0.38082955</td></tr>
	<tr><td>sewage_facility                       </td><td>0.21241222</td></tr>
	<tr><td>attribute_change_floor_area_ratio     </td><td>0.01584907</td></tr>
	<tr><td>attribute_change_address              </td><td>0.08791066</td></tr>
	<tr><td>attribute_change_acreage              </td><td>0.05249935</td></tr>
	<tr><td>attribute_change_current_use          </td><td>0.09532450</td></tr>
	<tr><td>attribute_change_building_structure   </td><td>0.09203122</td></tr>
	<tr><td>attribute_change_distance_from_station</td><td>0.07329960</td></tr>
	<tr><td>attribute_change_use_district         </td><td>0.01120769</td></tr>
	<tr><td>attribute_change_fire_area            </td><td>0.08577371</td></tr>
	<tr><td>attribute_change_urban_planning_area  </td><td>0.01120769</td></tr>
	<tr><td>attribute_change_forest_law           </td><td>0.00000000</td></tr>
	<tr><td>attribute_change_parks_law            </td><td>0.00000000</td></tr>
	<tr><td>attribute_change_building_coverage    </td><td>0.01584907</td></tr>
	<tr><td>common_surveyed_position              </td><td>0.26480641</td></tr>
</tbody>
</table>

</div>

<p>ここでは <code class="highlighter-rouge">skimr::</code> で</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># skimr::skim(df_lp) # Rコンソールでの実行は skim() で構いません</span><span class="w">
</span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">skimr</span><span class="o">::</span><span class="n">skim_to_list</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
<dl>
	<dt>$character</dt>
		<dd><table>
<caption>A tbl: 11 × 8</caption>
<thead>
	<tr>&lt;th scope=col&gt;variable&lt;/th&gt;&lt;th scope=col&gt;missing&lt;/th&gt;&lt;th scope=col&gt;complete&lt;/th&gt;&lt;th scope=col&gt;n&lt;/th&gt;&lt;th scope=col&gt;min&lt;/th&gt;&lt;th scope=col&gt;max&lt;/th&gt;&lt;th scope=col&gt;empty&lt;/th&gt;&lt;th scope=col&gt;n_unique&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>administrative_area_code             </td><td>0   </td><td>7961</td><td>7961</td><td>5 </td><td>5 </td><td>0</td><td>317 </td></tr>
	<tr><td>attribute_change_selected_land_status</td><td>0   </td><td>7961</td><td>7961</td><td>1 </td><td>1 </td><td>0</td><td>3   </td></tr>
	<tr><td>building_structure                   </td><td>189 </td><td>7772</td><td>7961</td><td>2 </td><td>8 </td><td>0</td><td>130 </td></tr>
	<tr><td>configuration                        </td><td>7087</td><td>874 </td><td>7961</td><td>2 </td><td>3 </td><td>0</td><td>2   </td></tr>
	<tr><td>current_use                          </td><td>0   </td><td>7961</td><td>7961</td><td>2 </td><td>14</td><td>0</td><td>69  </td></tr>
	<tr><td>fire_area                            </td><td>4344</td><td>3617</td><td>7961</td><td>2 </td><td>2 </td><td>0</td><td>2   </td></tr>
	<tr><td>name_of_nearest_station              </td><td>0   </td><td>7961</td><td>7961</td><td>1 </td><td>14</td><td>0</td><td>1424</td></tr>
	<tr><td>prefecture                           </td><td>0   </td><td>7961</td><td>7961</td><td>3 </td><td>4 </td><td>0</td><td>7   </td></tr>
	<tr><td>surrounding_present_usage            </td><td>0   </td><td>7961</td><td>7961</td><td>15</td><td>22</td><td>0</td><td>4047</td></tr>
	<tr><td>urban_planning_area                  </td><td>0   </td><td>7961</td><td>7961</td><td>2 </td><td>3 </td><td>0</td><td>3   </td></tr>
	<tr><td>use_district                         </td><td>0   </td><td>7961</td><td>7961</td><td>2 </td><td>3 </td><td>0</td><td>12  </td></tr>
</tbody>
</table>
</dd>
	<dt>$integer</dt>
		<dd><table>
<caption>A tbl: 5 × 12</caption>
<thead>
	<tr>&lt;th scope=col&gt;variable&lt;/th&gt;&lt;th scope=col&gt;missing&lt;/th&gt;&lt;th scope=col&gt;complete&lt;/th&gt;&lt;th scope=col&gt;n&lt;/th&gt;&lt;th scope=col&gt;mean&lt;/th&gt;&lt;th scope=col&gt;sd&lt;/th&gt;&lt;th scope=col&gt;p0&lt;/th&gt;&lt;th scope=col&gt;p25&lt;/th&gt;&lt;th scope=col&gt;p50&lt;/th&gt;&lt;th scope=col&gt;p75&lt;/th&gt;&lt;th scope=col&gt;p100&lt;/th&gt;&lt;th scope=col&gt;hist&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>acreage                  </td><td>0</td><td>7961</td><td>7961</td><td>   748.05 </td><td>   7468.15</td><td>46  </td><td>136  </td><td>176   </td><td>249   </td><td>413215  </td><td>▇▁▁▁▁▁▁▁</td></tr>
	<tr><td>distance_from_station    </td><td>0</td><td>7961</td><td>7961</td><td>  1393.74 </td><td>   1711.62</td><td>0   </td><td>500  </td><td>900   </td><td>1700  </td><td>24000   </td><td>▇▁▁▁▁▁▁▁</td></tr>
	<tr><td>number_of_basement_floors</td><td>0</td><td>7961</td><td>7961</td><td>     0.081</td><td>      0.34</td><td>0   </td><td>0    </td><td>0     </td><td>0     </td><td>6       </td><td>▇▁▁▁▁▁▁▁</td></tr>
	<tr><td>number_of_floors         </td><td>0</td><td>7961</td><td>7961</td><td>     2.78 </td><td>      2.27</td><td>0   </td><td>2    </td><td>2     </td><td>3     </td><td>52      </td><td>▇▁▁▁▁▁▁▁</td></tr>
	<tr><td>posted_land_price        </td><td>0</td><td>7961</td><td>7961</td><td>440856.77 </td><td>1819677.45</td><td>5660</td><td>74500</td><td>167000</td><td>323000</td><td>55500000</td><td>▇▁▁▁▁▁▁▁</td></tr>
</tbody>
</table>
</dd>
	<dt>$logical</dt>
		<dd><table>
<caption>A tbl: 17 × 6</caption>
<thead>
	<tr>&lt;th scope=col&gt;variable&lt;/th&gt;&lt;th scope=col&gt;missing&lt;/th&gt;&lt;th scope=col&gt;complete&lt;/th&gt;&lt;th scope=col&gt;n&lt;/th&gt;&lt;th scope=col&gt;mean&lt;/th&gt;&lt;th scope=col&gt;count&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>attribute_change_acreage              </td><td>0</td><td>7961</td><td>7961</td><td>0.0028 </td><td>FAL: 7939, TRU: 22, NA: 0  </td></tr>
	<tr><td>attribute_change_address              </td><td>0</td><td>7961</td><td>7961</td><td>0.0078 </td><td>FAL: 7899, TRU: 62, NA: 0  </td></tr>
	<tr><td>attribute_change_building_coverage    </td><td>0</td><td>7961</td><td>7961</td><td>0.00025</td><td>FAL: 7959, TRU: 2, NA: 0   </td></tr>
	<tr><td>attribute_change_building_structure   </td><td>0</td><td>7961</td><td>7961</td><td>0.0085 </td><td>FAL: 7893, TRU: 68, NA: 0  </td></tr>
	<tr><td>attribute_change_current_use          </td><td>0</td><td>7961</td><td>7961</td><td>0.0092 </td><td>FAL: 7888, TRU: 73, NA: 0  </td></tr>
	<tr><td>attribute_change_distance_from_station</td><td>0</td><td>7961</td><td>7961</td><td>0.0054 </td><td>FAL: 7918, TRU: 43, NA: 0  </td></tr>
	<tr><td>attribute_change_fire_area            </td><td>0</td><td>7961</td><td>7961</td><td>0.0074 </td><td>FAL: 7902, TRU: 59, NA: 0  </td></tr>
	<tr><td>attribute_change_floor_area_ratio     </td><td>0</td><td>7961</td><td>7961</td><td>0.00025</td><td>FAL: 7959, TRU: 2, NA: 0   </td></tr>
	<tr><td>attribute_change_forest_law           </td><td>0</td><td>7961</td><td>7961</td><td>0      </td><td>FAL: 7961, NA: 0           </td></tr>
	<tr><td>attribute_change_parks_law            </td><td>0</td><td>7961</td><td>7961</td><td>0      </td><td>FAL: 7961, NA: 0           </td></tr>
	<tr><td>attribute_change_supplied_facility    </td><td>0</td><td>7961</td><td>7961</td><td>0.0055 </td><td>FAL: 7917, TRU: 44, NA: 0  </td></tr>
	<tr><td>attribute_change_urban_planning_area  </td><td>0</td><td>7961</td><td>7961</td><td>0.00013</td><td>FAL: 7960, TRU: 1, NA: 0   </td></tr>
	<tr><td>attribute_change_use_district         </td><td>0</td><td>7961</td><td>7961</td><td>0.00013</td><td>FAL: 7960, TRU: 1, NA: 0   </td></tr>
	<tr><td>common_surveyed_position              </td><td>0</td><td>7961</td><td>7961</td><td>0.076  </td><td>FAL: 7357, TRU: 604, NA: 0 </td></tr>
	<tr><td>gas_facility                          </td><td>0</td><td>7961</td><td>7961</td><td>0.82   </td><td>TRU: 6560, FAL: 1401, NA: 0</td></tr>
	<tr><td>sewage_facility                       </td><td>0</td><td>7961</td><td>7961</td><td>0.95   </td><td>TRU: 7584, FAL: 377, NA: 0 </td></tr>
	<tr><td>water_facility                        </td><td>0</td><td>7961</td><td>7961</td><td>1      </td><td>TRU: 7953, FAL: 8, NA: 0   </td></tr>
</tbody>
</table>
</dd>
	<dt>$numeric</dt>
		<dd><table>
<caption>A tbl: 4 × 12</caption>
<thead>
	<tr>&lt;th scope=col&gt;variable&lt;/th&gt;&lt;th scope=col&gt;missing&lt;/th&gt;&lt;th scope=col&gt;complete&lt;/th&gt;&lt;th scope=col&gt;n&lt;/th&gt;&lt;th scope=col&gt;mean&lt;/th&gt;&lt;th scope=col&gt;sd&lt;/th&gt;&lt;th scope=col&gt;p0&lt;/th&gt;&lt;th scope=col&gt;p25&lt;/th&gt;&lt;th scope=col&gt;p50&lt;/th&gt;&lt;th scope=col&gt;p75&lt;/th&gt;&lt;th scope=col&gt;p100&lt;/th&gt;&lt;th scope=col&gt;hist&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>building_coverage</td><td>0</td><td>7961</td><td>7961</td><td> 60.38</td><td> 12.21</td><td>30</td><td>50 </td><td> 60  </td><td> 60  </td><td>  80  </td><td>▁▂▁▃▇▁▁▃</td></tr>
	<tr><td>depth_ratio      </td><td>0</td><td>7961</td><td>7961</td><td>  1.47</td><td>  0.55</td><td>1 </td><td>1  </td><td>  1.5</td><td>  1.5</td><td>   6.5</td><td>▇▂▁▁▁▁▁▁</td></tr>
	<tr><td>floor_area_ratio </td><td>0</td><td>7961</td><td>7961</td><td>218.63</td><td>145.24</td><td>50</td><td>100</td><td>200  </td><td>200  </td><td>1300  </td><td>▇▁▁▁▁▁▁▁</td></tr>
	<tr><td>frontage_ratio   </td><td>0</td><td>7961</td><td>7961</td><td>  1.07</td><td>  0.21</td><td>1 </td><td>1  </td><td>  1  </td><td>  1  </td><td>   5.5</td><td>▇▁▁▁▁▁▁▁</td></tr>
</tbody>
</table>
</dd>
</dl>

</div>

<p>論理型データのうち、<code class="highlighter-rouge">attribute_change_forest_law</code> と <code class="highlighter-rouge">attribute_change_parks_law</code> は FALSEのみが出現していることがわかります。</p>

<h2 id="探索的データ分析">探索的データ分析</h2>

<p>モデリングでは、目的変数の挙動（予測、分類）を明らかにすることが</p>

<p>ゴールとして設定</p>

<p>そのため、まずはモデリングの目的変数となるデータを詳しく見ることを勧めます。</p>

<p>目的変数について理解を深めることは重要です。データの分布から見えてくることがあります。</p>

<p>また、目的変数に影響する説明変数、説明変数間の関係を明らかにすることで、次のモデリングプロセスに活かせる知識が得られることが期待できます。（対数変換の必要性とか）</p>

<p>ヒストグラム、箱ひげ図を利用します。一変量を対象とした単純な可視化は、目的の値の変動、特性を理解するのに役立ちます。
（さらに調査する必要があるか）</p>

<p>作図の種類にはたくさんのものがあります。これらは次のような用途に応じて使い分けられます。</p>

<ul>
  <li>散布図</li>
  <li>pairwise correlation plot</li>
  <li>line plots</li>
</ul>

<p>ここで作る図は、初期モデルを構築する前段階で示唆を提供するものであると望ましいです。</p>

<p>論文や書籍、プレゼンテーションのための図ではありません。</p>

<p>また、変数が多くなるほど確認する図の数が多くなり、効率的ではなくなります。</p>

<p>一方で複雑な図を作ることは求められていません。</p>

<p>ライブラリやツールを利用することが良いでしょう。</p>

<p>振り返ってやり直すこともある。</p>

<ul>
  <li>モデリング前</li>
  <li>モデリング後の可視化</li>
</ul>

<p>引き続き、XXデータを使います。</p>

<p><strong>地価データ</strong></p>

<p><strong>ビールデータ</strong></p>

<p><strong>ハザードデータ</strong></p>

<h2 id="数値データ">数値データ</h2>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_num</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is_numeric</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="カテゴリデータ">カテゴリデータ</h2>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_cat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.character</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">verify</span><span class="p">(</span><span class="n">ncol</span><span class="p">(</span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">11</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_cat</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">count</span><span class="p">(</span><span class="n">name_of_nearest_station</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
<table>
<caption>A tibble: 1424 × 2</caption>
<thead>
	<tr>&lt;th scope=col&gt;name_of_nearest_station&lt;/th&gt;&lt;th scope=col&gt;n&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;int&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>本厚木    </td><td>54</td></tr>
	<tr><td>平塚      </td><td>49</td></tr>
	<tr><td>宇都宮    </td><td>48</td></tr>
	<tr><td>水戸      </td><td>48</td></tr>
	<tr><td>八王子    </td><td>47</td></tr>
	<tr><td>川崎      </td><td>40</td></tr>
	<tr><td>柏        </td><td>40</td></tr>
	<tr><td>木更津    </td><td>34</td></tr>
	<tr><td>千葉      </td><td>33</td></tr>
	<tr><td>大宮      </td><td>33</td></tr>
	<tr><td>戸塚      </td><td>31</td></tr>
	<tr><td>三鷹      </td><td>31</td></tr>
	<tr><td>逗子      </td><td>31</td></tr>
	<tr><td>前橋      </td><td>31</td></tr>
	<tr><td>橋本      </td><td>29</td></tr>
	<tr><td>茅ケ崎    </td><td>28</td></tr>
	<tr><td>君津      </td><td>28</td></tr>
	<tr><td>古河      </td><td>28</td></tr>
	<tr><td>東武宇都宮</td><td>28</td></tr>
	<tr><td>熊谷      </td><td>27</td></tr>
	<tr><td>土浦      </td><td>27</td></tr>
	<tr><td>小山      </td><td>26</td></tr>
	<tr><td>秦野      </td><td>25</td></tr>
	<tr><td>蕨        </td><td>25</td></tr>
	<tr><td>五井      </td><td>24</td></tr>
	<tr><td>川口      </td><td>24</td></tr>
	<tr><td>太田      </td><td>23</td></tr>
	<tr><td>本八幡    </td><td>23</td></tr>
	<tr><td>稲毛      </td><td>22</td></tr>
	<tr><td>高崎      </td><td>22</td></tr>
	<tr><td>⋮</td><td>⋮</td></tr>
	<tr><td>舞岡        </td><td>1</td></tr>
	<tr><td>風祭        </td><td>1</td></tr>
	<tr><td>福浦        </td><td>1</td></tr>
	<tr><td>片瀬江ノ島  </td><td>1</td></tr>
	<tr><td>宝町        </td><td>1</td></tr>
	<tr><td>北鹿沼      </td><td>1</td></tr>
	<tr><td>北習志野    </td><td>1</td></tr>
	<tr><td>北真岡      </td><td>1</td></tr>
	<tr><td>北水海道    </td><td>1</td></tr>
	<tr><td>北藤岡      </td><td>1</td></tr>
	<tr><td>北府中      </td><td>1</td></tr>
	<tr><td>堀切        </td><td>1</td></tr>
	<tr><td>本所吾妻橋  </td><td>1</td></tr>
	<tr><td>本蓮沼      </td><td>1</td></tr>
	<tr><td>茂林寺前    </td><td>1</td></tr>
	<tr><td>木場        </td><td>1</td></tr>
	<tr><td>門沢橋      </td><td>1</td></tr>
	<tr><td>野崎        </td><td>1</td></tr>
	<tr><td>野州大塚    </td><td>1</td></tr>
	<tr><td>野島公園    </td><td>1</td></tr>
	<tr><td>柳小路      </td><td>1</td></tr>
	<tr><td>柳瀬川      </td><td>1</td></tr>
	<tr><td>友部        </td><td>1</td></tr>
	<tr><td>立会川      </td><td>1</td></tr>
	<tr><td>緑が丘      </td><td>1</td></tr>
	<tr><td>六本木一丁目</td><td>1</td></tr>
	<tr><td>和戸        </td><td>1</td></tr>
	<tr><td>和泉多摩川  </td><td>1</td></tr>
	<tr><td>楡木        </td><td>1</td></tr>
	<tr><td>茗荷谷      </td><td>1</td></tr>
</tbody>
</table>

</div>

<h2 id="論理値">論理値</h2>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"."</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.logical</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">verify</span><span class="p">(</span><span class="n">ncol</span><span class="p">(</span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">17</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gg_count_var</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">var</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rlang</span><span class="o">::</span><span class="n">enquo</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="w">
  </span><span class="n">var_label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rlang</span><span class="o">::</span><span class="n">quo_name</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="w">
  </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">count</span><span class="p">(</span><span class="o">!!</span><span class="n">var</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">forcats</span><span class="o">::</span><span class="n">fct_reorder</span><span class="p">(</span><span class="o">!!</span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var_label</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">coord_flip</span><span class="p">()</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_cat</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">stringr</span><span class="o">::</span><span class="n">str_detect</span><span class="p">(</span><span class="n">administrative_area_code</span><span class="p">,</span><span class="w"> </span><span class="s2">"^08"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">gg_count_var</span><span class="p">(</span><span class="n">name_of_nearest_station</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="output output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    Error in df_is_cat %&gt;% filter(stringr::str_detect(administrative_area_code, : could not find function "%&gt;%"
    Traceback:



</code></pre></div></div>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">purrr</span><span class="o">::</span><span class="n">map</span><span class="p">(</span><span class="w">
  </span><span class="n">rlang</span><span class="o">::</span><span class="n">syms</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">df_is_cat</span><span class="p">)),</span><span class="w">
  </span><span class="o">~</span><span class="w"> </span><span class="n">gg_count_var</span><span class="p">(</span><span class="n">df_is_cat</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
                     </span><span class="n">filter</span><span class="p">(</span><span class="n">stringr</span><span class="o">::</span><span class="n">str_detect</span><span class="p">(</span><span class="n">administrative_area_code</span><span class="p">,</span><span class="w"> </span><span class="s2">"^08"</span><span class="p">)),</span><span class="w"> 
                 </span><span class="o">!!</span><span class="n">.x</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<!-- The driving goal in everything that we do in the modeling process is to find reproducible ways to explain the variation in the response. As discussed in the previous chapter, discovering patterns among the predictors that are related to the response involves selecting a resampling scheme to protect against overfitting, choosing a performance metric, tuning and training multiple models, and comparing model performance to identify which models have the best performance. When presented with a new data set, it is tempting to jump directly into the predictive modeling process to see if we can quickly develop a model that meets the performance expectations. Or, in the case where there are many predictors, the initial goal may be to use the modeling results to identify the most important predictors related to the response. But as illustrated in Figure 1.4, a sufficient amount of time should be spent exploring the data. The focus of this chapter will be to present approaches for visually exploring data and to demonstrate how this approach can be used to help guide feature engineering. -->

<h3 id="全体">全体</h3>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vis_dat</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_38_0.png" alt="png" /></p>

<h3 id="1変数の可視化">1変数の可視化</h3>

<p>データのばらつきや分布をみるのに効率的な方法です。</p>

<h4 id="ヒストグラム">ヒストグラム</h4>

<p>スパイク（峰）</p>

<p>単峰、二峰 etc.</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">posted_land_price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_40_0.png" alt="png" /></p>

<!-- box-cox変換をする図をあとで -->

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">posted_land_price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_density</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">prefecture</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_42_0.png" alt="png" /></p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggridges</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_lp_kanto</span><span class="p">,</span><span class="w"> 
       </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posted_land_price</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">prefecture</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_log10</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggridges</span><span class="o">::</span><span class="n">geom_density_ridges</span><span class="p">(</span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_43_0.png" alt="png" /></p>

<h4 id="箱ひげ図バイオリンプロット">箱ひげ図・バイオリンプロット</h4>

<h3 id="2変数の可視化">2変数の可視化</h3>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">use_district</span><span class="p">,</span><span class="w"> </span><span class="n">posted_land_price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_boxplot</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_46_0.png" alt="png" /></p>

<h4 id="散布図">散布図</h4>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">distance_from_station</span><span class="p">,</span><span class="w"> </span><span class="n">posted_land_price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_48_0.png" alt="png" /></p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">distance_from_station</span><span class="p">,</span><span class="w"> </span><span class="n">acreage</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_49_0.png" alt="png" /></p>

<h2 id="特殊なデータの視覚化">特殊なデータの視覚化</h2>

<h3 id="時系列データ">時系列データ</h3>

<p>時系列データを扱うときは、時間のならびの通りに表示させることが肝心です。</p>

<p>周期があるものは分割したり重ねてみると良いかも</p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_beer2018q2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">expense</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_date</span><span class="p">(</span><span class="n">date_breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"7 days"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_51_0.png" alt="png" /></p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_beer2018q2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">expense</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_52_0.png" alt="png" /></p>

<h3 id="空間データ">空間データ</h3>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sf_lp_kanto</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">df_lp_kanto</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">select</span><span class="p">(</span><span class="n">prefecture</span><span class="p">,</span><span class="w"> </span><span class="n">posted_land_price</span><span class="p">,</span><span class="w"> </span><span class="n">.longitude</span><span class="p">,</span><span class="w"> </span><span class="n">.latitude</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">st_as_sf</span><span class="p">(</span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">".longitude"</span><span class="p">,</span><span class="w"> </span><span class="s2">".latitude"</span><span class="p">),</span><span class="w"> </span><span class="n">crs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4326</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">sf_lp_kanto</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_sf</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posted_land_price</span><span class="p">),</span><span class="w">
          </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"transparent"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_viridis_c</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_54_0.png" alt="png" /></p>

<!-- ksjのクレジット -->

<p>アンスコムの例</p>

<h3 id="高次元の可視化">高次元の可視化</h3>

<p>2次元以上の</p>

<h4 id="ヒートマップ">ヒートマップ</h4>

<p>変数間の関係、特に相関や欠損関係がある場合に役立ちます。</p>

<h4 id="散布図行列">散布図行列</h4>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_num</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">GGally</span><span class="o">::</span><span class="n">ggpairs</span><span class="p">()</span><span class="w">

</span><span class="n">df_is_num</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">corrr</span><span class="o">::</span><span class="n">correlate</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="output output_html">
<table>
<caption>A cor_df: 9 × 10</caption>
<thead>
	<tr>&lt;th scope=col&gt;rowname&lt;/th&gt;&lt;th scope=col&gt;posted_land_price&lt;/th&gt;&lt;th scope=col&gt;distance_from_station&lt;/th&gt;&lt;th scope=col&gt;acreage&lt;/th&gt;&lt;th scope=col&gt;depth_ratio&lt;/th&gt;&lt;th scope=col&gt;number_of_floors&lt;/th&gt;&lt;th scope=col&gt;number_of_basement_floors&lt;/th&gt;&lt;th scope=col&gt;building_coverage&lt;/th&gt;&lt;th scope=col&gt;frontage_ratio&lt;/th&gt;&lt;th scope=col&gt;floor_area_ratio&lt;/th&gt;</tr>
	<tr>&lt;th scope=col&gt;&lt;chr&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;&lt;th scope=col&gt;&lt;dbl&gt;&lt;/th&gt;</tr>
</thead>
<tbody>
	<tr><td>posted_land_price        </td><td>          NA</td><td>-0.12569556</td><td> 0.008325032</td><td> 0.035318432</td><td> 0.43575145</td><td> 0.54212619</td><td> 0.219008524</td><td> 0.05208925</td><td> 0.475119082</td></tr>
	<tr><td>distance_from_station    </td><td>-0.125695563</td><td>         NA</td><td> 0.055539845</td><td>-0.058296485</td><td>-0.22518578</td><td>-0.14142070</td><td>-0.223526922</td><td>-0.01190656</td><td>-0.247763455</td></tr>
	<tr><td>acreage                  </td><td> 0.008325032</td><td> 0.05553984</td><td>          NA</td><td> 0.007448354</td><td>-0.01239013</td><td> 0.01656375</td><td> 0.005623651</td><td> 0.04439868</td><td> 0.009836352</td></tr>
	<tr><td>depth_ratio              </td><td> 0.035318432</td><td>-0.05829648</td><td> 0.007448354</td><td>          NA</td><td> 0.09296341</td><td> 0.04112338</td><td> 0.275825237</td><td>-0.27393794</td><td> 0.218882108</td></tr>
	<tr><td>number_of_floors         </td><td> 0.435751449</td><td>-0.22518578</td><td>-0.012390130</td><td> 0.092963407</td><td>         NA</td><td> 0.54821812</td><td> 0.486307961</td><td> 0.08079867</td><td> 0.692709498</td></tr>
	<tr><td>number_of_basement_floors</td><td> 0.542126188</td><td>-0.14142070</td><td> 0.016563753</td><td> 0.041123382</td><td> 0.54821812</td><td>         NA</td><td> 0.276671976</td><td> 0.04071109</td><td> 0.495451275</td></tr>
	<tr><td>building_coverage        </td><td> 0.219008524</td><td>-0.22352692</td><td> 0.005623651</td><td> 0.275825237</td><td> 0.48630796</td><td> 0.27667198</td><td>          NA</td><td> 0.03729320</td><td> 0.804167426</td></tr>
	<tr><td>frontage_ratio           </td><td> 0.052089252</td><td>-0.01190656</td><td> 0.044398678</td><td>-0.273937938</td><td> 0.08079867</td><td> 0.04071109</td><td> 0.037293202</td><td>         NA</td><td> 0.057795901</td></tr>
	<tr><td>floor_area_ratio         </td><td> 0.475119082</td><td>-0.24776345</td><td> 0.009836352</td><td> 0.218882108</td><td> 0.69270950</td><td> 0.49545127</td><td> 0.804167426</td><td> 0.05779590</td><td>          NA</td></tr>
</tbody>
</table>

</div>

<p class="output output_png"><img src="/Users/suryu/Library/Mobile%20Documents/com~apple~CloudDocs/jupyter_book/practical-ds/_build/images/01/eda_57_1.png" alt="png" /></p>

<div class="language-R input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_is_num</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">vis_cor</span><span class="p">()</span><span class="w">

</span><span class="n">df_is_log</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">as.numeric</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">vis_cor</span><span class="p">()</span><span class="w">

</span><span class="n">all.equal</span><span class="p">(</span><span class="w">
  </span><span class="n">df_lp_kanto</span><span class="o">$</span><span class="n">attribute_change_building_coverage</span><span class="p">,</span><span class="w">
  </span><span class="n">df_lp_kanto</span><span class="o">$</span><span class="n">attribute_change_floor_area_ratio</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h4 id="pca">PCA</h4>

<h4 id="モデルの利用">モデルの利用</h4>

<p>EDAのとっかかりを得るために</p>

<p>木ベースのモデルのfeature importanceを活用する</p>

<!-- 解釈の項目で触れる? -->

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/practical-ds/01/introduction">
      〈 <span class="u-margin-right-tiny"></span> データ分析のプロセス
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/practical-ds/01/tidy_data">
      tidyデータ <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
